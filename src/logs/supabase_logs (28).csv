"event_message","event_type","function_id","id","level","timestamp"
"Webhook error: Error: null value in column "current_period_end" of relation "subscriptions" violates not-null constraint
    at handlePaymentSucceeded (file:///Users/chira/habitoff/supabase/functions/dodo-webhook/index.ts:92:13)
    at eventLoopTick (ext:core/01_core.js:168:7)
    at async Server.<anonymous> (file:///Users/chira/habitoff/supabase/functions/dodo-webhook/index.ts:206:9)
    at async #respond (https://deno.land/std@0.168.0/http/server.ts:221:18)
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","83f066de-e09f-4063-9210-217c97cccf5c","error","1738693034543537"
"Error in handlePaymentSucceeded: Error: null value in column "current_period_end" of relation "subscriptions" violates not-null constraint
    at handlePaymentSucceeded (file:///Users/chira/habitoff/supabase/functions/dodo-webhook/index.ts:92:13)
    at eventLoopTick (ext:core/01_core.js:168:7)
    at async Server.<anonymous> (file:///Users/chira/habitoff/supabase/functions/dodo-webhook/index.ts:206:9)
    at async #respond (https://deno.land/std@0.168.0/http/server.ts:221:18)
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","cbb499a5-b854-4a03-9c95-305f0ac8ae6e","error","1738693034543280"
"Payment processing failed: null value in column "current_period_end" of relation "subscriptions" violates not-null constraint
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","2fd8291a-2262-47cf-95d9-d23f9015dd96","error","1738693034542974"
"Processing event: {
  type: "payment.succeeded",
  event_id: undefined,
  timestamp: "2025-02-04T18:17:09.636Z"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","bbcc7042-1bd3-41a1-b4e3-60f707bfa584","log","1738693034542685"
"Webhook headers: {
  webhookId: "evt_XalKCjHMBdUUbGR2OaXxk",
  signature: "v1,hd+swd6cPfG1DpAxhNbr6mJonNeE7LjXaNILXVqLano=",
  timestamp: "1738693026"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","bb9ddaa4-583c-44f5-876f-4a06a460b30d","log","1738693034542507"
"Received webhook event: {
  body: '{"business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","type":"payment.succeeded","timestamp":"2025-02-04T18:17:06.163475362Z","data":{"payload_type":"Payment","payment_id":"pay_gcy5bAEMV7SlUX61ieAFi","business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","status":"succeeded","total_amount":51053,"currency":"INR","payment_method":"card","payment_method_type":null,"created_at":"2025-02-04T18:16:51.035156Z","updated_at":null,"disputes":[],"refunds":[],"customer":{"customer_id":"cus_rQ5jMXxKouAg3MZoDXLI9","name":"chirag TALWAR","email":"workwithchiragt@gmail.com"},"subscription_id":null,"product_cart":[{"product_id":"pdt_gUut7yIhw8NffnEkF9cqW","quantity":1}],"payment_link":"https://test.checkout.dodopayments.com/r6i7VWlx","tax":7788,"metadata":{}}}',
  timestamp: "2025-02-04T18:17:09.632Z",
  headers: {
    accept: "*/*",
    "accept-encoding": "gzip",
    "cdn-loop": "cloudflare; loops=1; subreqs=1",
    "cf-connecting-ip": "34.100.153.98",
    "cf-ew-via": "15",
    "cf-ray": "90cca7d9877ef2eb-BOM",
    "cf-visitor": '{"scheme":"https"}',
    "cf-worker": "supabase.co",
    "content-length": "730",
    "content-type": "application/json",
    host: "edge-runtime.supabase.com",
    "user-agent": "DodoPayments/v1",
    "webhook-id": "evt_XalKCjHMBdUUbGR2OaXxk",
    "webhook-signature": "v1,hd+swd6cPfG1DpAxhNbr6mJonNeE7LjXaNILXVqLano=",
    "webhook-timestamp": "1738693026",
    "x-amzn-trace-id": "Root=1-67a259a2-60e042f04bb2ba5f77ff920a",
    "x-deno-subhost": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6InN1cGFiYXNlIn0.eyJwcm9qZWN0X3JlZiI6InFkd2Jra2t1dHZncWRrcnprbmVwIiwibmFtZSI6ImRvZG8td2ViaG9vayIsInBsYW4iOiJ0aWVyX2ZyZWUiLCJycGNfcm9vdCI6Imh0dHBzOi8vc3VwYWJhc2Utb3JpZ2luLmRlbm8uZGV2L3YwLyIsImV4cCI6MTczODY5MzkyNiwiaWF0IjoxNzM4NjkzMDI2fQ.EjKauwZa_ZMNEBz7nrNn8EqILA-M5DsqeNXBWbxS-fs",
    "x-forwarded-for": "34.100.153.98,34.100.153.98, 13.248.105.45",
    "x-forwarded-host": "edge-runtime.supabase.com",
    "x-forwarded-port": "443",
    "x-forwarded-proto": "https"
  }
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","4f4ab0a7-ee77-4b3d-bedb-fbbdb7c0fd42","log","1738693034542344"
"Listening on http://localhost:9999/
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","1fa71656-5bd1-4084-88d0-532daec1e1fc","log","1738693034542139"
"booted (time: 28ms)","Boot","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","a124f3d5-a6f5-4b02-bb7b-cad8d6c2279d","log","1738693034541915"
"shutdown","Shutdown","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","610e3b75-5d5d-470f-b6e9-bf4c11ea9462","log","1738692873934354"
"Successfully processed payment: {
  userId: "a152b8e3-acd1-4824-8a4d-362f78d3d020",
  payment_id: "pay_CBbBm4rUDciqwCMnKst5V",
  is_lifetime: true,
  result: {
    success: false,
    error: 'null value in column "current_period_end" of relation "subscriptions" violates not-null constraint'
  }
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","00dd42ad-135b-48e1-b7f9-691c38e7b1ae","log","1738692798921042"
"Processing event: {
  type: "payment.succeeded",
  event_id: undefined,
  timestamp: "2025-02-04T18:13:18.531Z"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","280b7bad-8b39-484d-9011-472f1d37b243","log","1738692798920901"
"Webhook headers: {
  webhookId: "evt_XLgwogkSQRxsipOM09blS",
  signature: "v1,K7YVa4lsksiuulUZPIGwcvdDF6m9dYNVnb8E0Xc4Nj4=",
  timestamp: "1738692797"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","41055e09-0bdd-422f-83b1-e2f6705c21a7","log","1738692798920735"
"Received webhook event: {
  body: '{"business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","type":"payment.succeeded","timestamp":"2025-02-04T18:13:17.509726165Z","data":{"payload_type":"Payment","payment_id":"pay_CBbBm4rUDciqwCMnKst5V","business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","status":"succeeded","total_amount":51053,"currency":"INR","payment_method":"card","payment_method_type":null,"created_at":"2025-02-04T18:13:03.049207Z","updated_at":null,"disputes":[],"refunds":[],"customer":{"customer_id":"cus_rQ5jMXxKouAg3MZoDXLI9","name":"chirag TALWAR","email":"workwithchiragt@gmail.com"},"subscription_id":null,"product_cart":[{"product_id":"pdt_gUut7yIhw8NffnEkF9cqW","quantity":1}],"payment_link":"https://test.checkout.dodopayments.com/Mq1SiAGG","tax":7788,"metadata":{}}}',
  timestamp: "2025-02-04T18:13:18.526Z",
  headers: {
    accept: "*/*",
    "accept-encoding": "gzip",
    "cdn-loop": "cloudflare; loops=1; subreqs=1",
    "cf-connecting-ip": "34.100.153.98",
    "cf-ew-via": "15",
    "cf-ray": "90cca245705b4043-BOM",
    "cf-visitor": '{"scheme":"https"}',
    "cf-worker": "supabase.co",
    "content-length": "730",
    "content-type": "application/json",
    host: "edge-runtime.supabase.com",
    "user-agent": "DodoPayments/v1",
    "webhook-id": "evt_XLgwogkSQRxsipOM09blS",
    "webhook-signature": "v1,K7YVa4lsksiuulUZPIGwcvdDF6m9dYNVnb8E0Xc4Nj4=",
    "webhook-timestamp": "1738692797",
    "x-amzn-trace-id": "Root=1-67a258be-341d67692496be1e60571385",
    "x-deno-subhost": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6InN1cGFiYXNlIn0.eyJwcm9qZWN0X3JlZiI6InFkd2Jra2t1dHZncWRrcnprbmVwIiwibmFtZSI6ImRvZG8td2ViaG9vayIsInBsYW4iOiJ0aWVyX2ZyZWUiLCJycGNfcm9vdCI6Imh0dHBzOi8vc3VwYWJhc2Utb3JpZ2luLmRlbm8uZGV2L3YwLyIsImV4cCI6MTczODY5MzY5OCwiaWF0IjoxNzM4NjkyNzk4fQ.hs7uPiOrLEv0rxoJ6ke734eS-Ji8drjLdsRDYiOjMiA",
    "x-forwarded-for": "34.100.153.98,34.100.153.98, 13.248.105.45",
    "x-forwarded-host": "edge-runtime.supabase.com",
    "x-forwarded-port": "443",
    "x-forwarded-proto": "https"
  }
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","58cbfa20-2e88-417e-8f65-aaf1729e51f0","log","1738692798920542"
"Listening on http://localhost:9999/
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","681e1b7f-403f-4f3d-9c60-6673062bfd61","log","1738692798920296"
"booted (time: 32ms)","Boot","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","f23df324-0b14-42b7-8ad8-3580092bb0e5","log","1738692798920039"
"shutdown","Shutdown","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","d59dbb29-8677-47ad-849f-ec69b5194c05","log","1738692694807574"
"Successfully processed payment: {
  userId: "a152b8e3-acd1-4824-8a4d-362f78d3d020",
  payment_id: "pay_bbK9n2cstjdGUsOmjrSLc",
  is_lifetime: true,
  result: {
    success: false,
    error: 'null value in column "current_period_end" of relation "subscriptions" violates not-null constraint'
  }
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","b26436f7-c39d-40e9-b5f9-9709352e08e3","log","1738692619848026"
"Processing event: {
  type: "payment.succeeded",
  event_id: undefined,
  timestamp: "2025-02-04T18:10:19.214Z"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","4725907e-df57-46ef-a967-04bf0db47ff7","log","1738692619847809"
"Webhook headers: {
  webhookId: "evt_3tcvnU4nmyBpZcR6UGs7o",
  signature: "v1,I9eh2P1HuIaH9cT0q4mmi33daw5r4ge5IDnNOQb/tWU=",
  timestamp: "1738692618"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","c0e8f684-3bd9-4c70-ab77-c86738cb6227","log","1738692619847518"
"Received webhook event: {
  body: '{"business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","type":"payment.succeeded","timestamp":"2025-02-04T18:10:18.395536879Z","data":{"payload_type":"Payment","payment_id":"pay_bbK9n2cstjdGUsOmjrSLc","business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","status":"succeeded","total_amount":51053,"currency":"INR","payment_method":"card","payment_method_type":null,"created_at":"2025-02-04T18:09:58.617573Z","updated_at":null,"disputes":[],"refunds":[],"customer":{"customer_id":"cus_rQ5jMXxKouAg3MZoDXLI9","name":"chirag TALWAR","email":"workwithchiragt@gmail.com"},"subscription_id":null,"product_cart":[{"product_id":"pdt_gUut7yIhw8NffnEkF9cqW","quantity":1}],"payment_link":"https://test.checkout.dodopayments.com/miMAD3C3","tax":7788,"metadata":{}}}',
  timestamp: "2025-02-04T18:10:19.210Z",
  headers: {
    accept: "*/*",
    "accept-encoding": "gzip",
    "cdn-loop": "cloudflare; loops=1; subreqs=1",
    "cf-connecting-ip": "34.100.153.98",
    "cf-ew-via": "15",
    "cf-ray": "90cc9de4b4564e0d-BOM",
    "cf-visitor": '{"scheme":"https"}',
    "cf-worker": "supabase.co",
    "content-length": "730",
    "content-type": "application/json",
    host: "edge-runtime.supabase.com",
    "user-agent": "DodoPayments/v1",
    "webhook-id": "evt_3tcvnU4nmyBpZcR6UGs7o",
    "webhook-signature": "v1,I9eh2P1HuIaH9cT0q4mmi33daw5r4ge5IDnNOQb/tWU=",
    "webhook-timestamp": "1738692618",
    "x-amzn-trace-id": "Root=1-67a2580b-1f2bbc420b24c96b43e7e108",
    "x-deno-subhost": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6InN1cGFiYXNlIn0.eyJwcm9qZWN0X3JlZiI6InFkd2Jra2t1dHZncWRrcnprbmVwIiwibmFtZSI6ImRvZG8td2ViaG9vayIsInBsYW4iOiJ0aWVyX2ZyZWUiLCJycGNfcm9vdCI6Imh0dHBzOi8vc3VwYWJhc2Utb3JpZ2luLmRlbm8uZGV2L3YwLyIsImV4cCI6MTczODY5MzUxOCwiaWF0IjoxNzM4NjkyNjE4fQ.TaHHILtOcPse2eA_2q9eCNo6f39wsfty69l5WF0oZfA",
    "x-forwarded-for": "34.100.153.98,34.100.153.98, 13.248.105.18",
    "x-forwarded-host": "edge-runtime.supabase.com",
    "x-forwarded-port": "443",
    "x-forwarded-proto": "https"
  }
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","3c93d6af-4034-4ec9-9a83-428bdf81a6e2","log","1738692619847236"
"Listening on http://localhost:9999/
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","616c5b94-cda0-4ca8-8161-9a456040119a","log","1738692619846910"
"booted (time: 30ms)","Boot","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","9ee59f98-91ea-4ea6-b6a1-92334756adf8","log","1738692619846657"
"shutdown","Shutdown","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","8bdc9614-70b3-40c3-a3fc-8e19bf461226","log","1738692488841990"
"Webhook error: {
  code: "PGRST202",
  details: "Searched for the function public.process_payment with parameters p_amount, p_currency, p_payment_id, p_subscription_id, p_user_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.",
  hint: "Perhaps you meant to call the function public.process_payment(p_amount, p_currency, p_is_lifetime, p_payment_id, p_subscription_id, p_user_id)",
  message: "Could not find the function public.process_payment(p_amount, p_currency, p_payment_id, p_subscription_id, p_user_id) in the schema cache"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","5506d9a7-ea16-4c16-895b-8fb019d8056a","error","1738692413876419"
"Error in handlePaymentSucceeded: {
  error: {
    code: "PGRST202",
    details: "Searched for the function public.process_payment with parameters p_amount, p_currency, p_payment_id, p_subscription_id, p_user_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.",
    hint: "Perhaps you meant to call the function public.process_payment(p_amount, p_currency, p_is_lifetime, p_payment_id, p_subscription_id, p_user_id)",
    message: "Could not find the function public.process_payment(p_amount, p_currency, p_payment_id, p_subscription_id, p_user_id) in the schema cache"
  },
  stack: undefined,
  timestamp: "2025-02-04T18:06:49.123Z"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","cb05041a-f555-49e9-867f-f0d783122f9c","error","1738692413876208"
"Error in payment transaction: {
  code: "PGRST202",
  details: "Searched for the function public.process_payment with parameters p_amount, p_currency, p_payment_id, p_subscription_id, p_user_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.",
  hint: "Perhaps you meant to call the function public.process_payment(p_amount, p_currency, p_is_lifetime, p_payment_id, p_subscription_id, p_user_id)",
  message: "Could not find the function public.process_payment(p_amount, p_currency, p_payment_id, p_subscription_id, p_user_id) in the schema cache"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","cd3b0f83-f8d2-4ddc-bbe3-c196f87a986a","error","1738692413875985"
"Processing event: {
  type: "payment.succeeded",
  event_id: undefined,
  timestamp: "2025-02-04T18:06:48.993Z"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","2bd08855-7d90-474f-b6c4-e0de67685f0f","log","1738692413875419"
"Webhook headers: {
  webhookId: "evt_umyvZy2YuYdUwAHC0GaDY",
  signature: "v1,kritN+5PJZfYKxVFpEMKqrxJC2xjzOLLpdNv+TL1cH8=",
  timestamp: "1738692408"
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","82d82646-2db1-49df-b72f-1dc0017db087","log","1738692413874594"
"Received webhook event: {
  body: '{"business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","type":"payment.succeeded","timestamp":"2025-02-04T16:15:36.042773781Z","data":{"payload_type":"Payment","payment_id":"pay_bn5KZd9J4aEkpzX1QHPoC","business_id":"bus_ohHLh9SuHeWIV8hb8mAUm","status":"succeeded","total_amount":0,"currency":"USD","payment_method":"card","payment_method_type":null,"created_at":"2025-02-04T16:15:25.044756Z","updated_at":null,"disputes":[],"refunds":[],"customer":{"customer_id":"cus_rQ5jMXxKouAg3MZoDXLI9","name":"chirag TALWAR","email":"workwithchiragt@gmail.com"},"subscription_id":"sub_RoJQsjhWgLnfnOCVdNcbz","product_cart":null,"payment_link":"https://test.checkout.dodopayments.com/vpi61WyW","tax":null,"metadata":{}}}',
  timestamp: "2025-02-04T18:06:48.989Z",
  headers: {
    accept: "*/*",
    "accept-encoding": "gzip",
    "cdn-loop": "cloudflare; loops=1; subreqs=1",
    "cf-connecting-ip": "34.100.153.98",
    "cf-ew-via": "15",
    "cf-ray": "90cc98c2d4886ed1-BOM",
    "cf-visitor": '{"scheme":"https"}',
    "cf-worker": "supabase.co",
    "content-length": "696",
    "content-type": "application/json",
    host: "edge-runtime.supabase.com",
    "user-agent": "DodoPayments/v1",
    "webhook-id": "evt_umyvZy2YuYdUwAHC0GaDY",
    "webhook-signature": "v1,kritN+5PJZfYKxVFpEMKqrxJC2xjzOLLpdNv+TL1cH8=",
    "webhook-timestamp": "1738692408",
    "x-amzn-trace-id": "Root=1-67a25738-04797a5447da07732d82aa34",
    "x-deno-subhost": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6InN1cGFiYXNlIn0.eyJwcm9qZWN0X3JlZiI6InFkd2Jra2t1dHZncWRrcnprbmVwIiwibmFtZSI6ImRvZG8td2ViaG9vayIsInBsYW4iOiJ0aWVyX2ZyZWUiLCJycGNfcm9vdCI6Imh0dHBzOi8vc3VwYWJhc2Utb3JpZ2luLmRlbm8uZGV2L3YwLyIsImV4cCI6MTczODY5MzMwOCwiaWF0IjoxNzM4NjkyNDA4fQ.2CDrLxV34rH4uTh3JxoKDveYggCw1PvfmWlhUIZMt1I",
    "x-forwarded-for": "34.100.153.98,34.100.153.98, 13.248.105.18",
    "x-forwarded-host": "edge-runtime.supabase.com",
    "x-forwarded-port": "443",
    "x-forwarded-proto": "https"
  }
}
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","ef4d87dc-1c20-4e7a-a580-5f6e38d24fef","log","1738692413873038"
"Listening on http://localhost:9999/
","Log","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","f1f84a5b-9b4a-4a1a-981b-df6d975e84f7","log","1738692413869127"
"booted (time: 30ms)","Boot","a9c2ddb8-d7ca-4282-88eb-09bfb0100f8f","2f8935e1-36b1-4aa3-9b65-91a466031649","log","1738692413867058"